---
title: "补充：R中的索引方式"
author: "王梓安"
date: "2025-03-21"
output:
  rmarkdown::html_document:
    toc: true # 开启目录
    toc_depth: 6 # 目录深度
    toc_float: true # 让目录浮动在左侧
    number_sections: false # 不自动生成目录
    code_download: true # 启用一键下载功能
    theme: cerulean
    highlight: pygments
    css: custom.css # 添加自定义CSS文件
    includes:
      in_header: header.html # 引入自定义HTML/JS文件
---

## （1）索引-数据抽屉

| 索引方式 | 说明 | 示例代码 | 适用数据结构 | 返回的数据类型 |
|----|----|----|----|----|
| **数字索引** | 使用数字索引来访问向量、矩阵、数据框中的元素。 | `v[3]` 获取向量第3个元素；`m[2, 3]` 获取矩阵第2行第3列元素 | 向量、矩阵、数据框、列表 | 向量：元素；矩阵：单个元素；数据框：单个值或子集（行或列） |
| **逻辑索引** | 使用逻辑条件来筛选数据，返回满足条件的元素。 | `v[v > 3]` 获取大于3的元素；`df[df$A > 3, ]` 获取A列大于3的行 | 向量、数据框、矩阵（矩阵按行或列筛选） | 向量：向量；数据框：数据框子集；矩阵：矩阵子集 |
| **字符索引** | 使用列名（字符）来访问数据框的列或列表的元素。 | `df$A` 获取数据框A列；`lst$name` 获取列表的name元素 | 数据框、列表 | 数据框：列（向量）；列表：单个元素（如向量、字符等） |
| **`which()`函数** | 返回满足条件的元素索引位置。 | `which(v > 3)` 返回大于3的元素位置 | 向量、数据框、矩阵 | 向量：返回满足条件的索引位置，以整数向量表示；矩阵/数据框：行或列索引（位置） |
| **负索引** | 排除特定的元素或行列。 | `v[-2]` 排除第二个元素；`m[, -2]` 排除矩阵的第二列 | 向量、矩阵、数据框（排除行或列） | 向量：向量（去除指定元素）；矩阵/数据框：矩阵/数据框（去除行或列） |
| **范围索引** | 使用范围来提取数据的部分。 | `v[2:4]` 获取第2到第4个元素；`m[1:2, 2:3]` 获取矩阵的一部分 | 向量、矩阵、数据框（按行列范围提取） | 向量：部分向量；矩阵/数据框：矩阵/数据框的子集 |
| **`subset()`函数** | 用于筛选数据框的行。 | `subset(df, A > 3)` 筛选A列大于3的行 | 数据框 | 数据框：筛选后的数据框（行子集） |
| **`[]`和 `[[]]`** | 用于提取数据框或列表的子集或单个元素。 | `df[1:3, "A"]` 获取数据框A列的前3行；`lst[["name"]]` 获取列表的单个元素 | 数据框（`[]`）和列表（`[]`、`[[]]`） | 数据框：数据框子集；列表：单个元素（如向量、字符等） |
| **`apply()`系列函数** | 用于对数据框、矩阵等应用函数。 | `apply(m, 1, sum)` 对矩阵的每一行求和 | 矩阵、数据框（`apply()`、`lapply()`、`sapply()`） | 矩阵：向量；数据框：向量或列表（取决于选择的apply系列函数） |

### 适用数据结构说明：

-   **向量**：一维数据结构，适用于基本的索引和逻辑索引。

-   **矩阵**：二维数据结构，适用于行列的数字、逻辑和范围索引。

-   **数据框**：表格型数据结构，适用于逻辑索引、字符索引、`subset()`等。

-   **列表**：包含不同类型元素的数据结构，适用于字符索引、`[[]]`等。

### 每种索引方式的输出类型：

-   **向量**：返回的是向量或其子集。

-   **矩阵**：返回矩阵或其子集。

-   **数据框**：返回数据框的行、列或子集。

-   **列表**：返回列表的单个元素（如向量、字符等）。

-   **`which()`函数**：返回满足条件的索引位置，以整数向量表示。

-   **`apply()`系列函数**：根据操作的对象（行或列），返回一个向量或列表。

## （2）索引介绍

在 R 中，有多种方式可以对数据进行索引操作。根据数据结构（如向量、矩阵、数据框等）的不同，索引的方式也会有所不同。以下是一些常见的索引方式：

### 1. 使用数字索引

-   **向量**：通过数字索引来获取向量中的元素。

-   **矩阵/数据框**：通过行列的数字索引来访问矩阵或数据框中的元素。

```{r eval=FALSE}
# 向量索引
v <- c(1, 2, 3, 4, 5)
v[3]  # 获取第3个元素，结果是 3

# 矩阵索引
m <- matrix(1:9, nrow=3, ncol=3)
m[2, 3]  # 获取第2行、第3列的元素，结果是 6

# 数据框索引
df <- data.frame(A = 1:5, B = 6:10)
df[2, 1]  # 获取第2行、第1列的元素，结果是 2

```

### 2. 使用逻辑索引

-   **向量**：可以通过布尔条件进行索引，返回满足条件的元素。

-   **矩阵/数据框**：可以使用逻辑条件对行或列进行筛选。

```{r eval=FALSE}
# 向量的逻辑索引
v <- c(1, 2, 3, 4, 5)
v[v > 3]  # 返回大于3的元素，结果是 c(4, 5)

# 数据框的逻辑索引
df <- data.frame(A = 1:5, B = 6:10)
df[df$A > 3, ]  # 返回A列大于3的行，结果是第4行和第5行

```

### 3. 使用字符索引

-   **数据框**：可以通过列名（字符型索引）来访问特定的列。

-   **列表**：通过元素的名字来索引。

```{r eval=FALSE}
# 数据框的字符索引
df <- data.frame(A = 1:5, B = 6:10)
df$A  # 获取A列，结果是 1, 2, 3, 4, 5

# 列表的字符索引
lst <- list(name = "John", age = 30)
lst$name  # 获取 name 元素，结果是 "John"

```

### 4. 使用`which()`函数

-   **`which()`** 返回满足特定条件的索引位置，通常用于结合逻辑条件索引。

```{r eval=FALSE}
v <- c(1, 2, 3, 6, 7)
which(v > 3)  # 返回满足条件的元素位置，结果是 4, 5

```

### 5. 使用负索引

-   **向量**：负数索引用来排除某些元素。

-   **矩阵/数据框**：也可以用负数来排除特定的行或列。

```{r eval=FALSE}
# 向量的负索引
v <- c(1, 2, 3, 4, 5)
v[-2]  # 排除第二个元素，结果是 c(1, 3, 4, 5)

# 矩阵的负索引
m <- matrix(1:9, nrow=3, ncol=3)
m[-1, ]  # 排除第一行，返回其余的行
m[, -2]  # 排除第二列，返回其余的列

```

### 6. 使用范围索引

-   **向量**：通过指定范围来获取一部分数据。

-   **矩阵/数据框**：通过指定行和列的范围来获取部分数据。

```{r eval=FALSE}
# 向量的范围索引
v <- c(1, 2, 3, 4, 5)
v[2:4]  # 获取第2到第4个元素，结果是 c(2, 3, 4)

# 矩阵的范围索引
m <- matrix(1:9, nrow=3, ncol=3)
m[1:2, 2:3]  # 获取第一到第二行和第二到第三列的元素

```

### 7. 使用`subset()`函数

-   `subset()`用于数据框的行筛选，类似于逻辑索引，但语法更简洁。

```{r eval=FALSE}
df <- data.frame(A = 1:5, B = 6:10)
subset(df, A > 3)  # 筛选A列大于3的行

```

### 8. 使用`[[]]` 和 `[]`

-   **`[]`** 用于提取数据框或列表的**子集**。

-   **`[[]]`** 用于提取列表的**单个元素**。

```{r eval=FALSE}
# 列表的 [[]] 索引
lst <- list(name = "John", age = 30)
lst[["name"]]  # 提取单个元素，结果是 "John"

# 数据框的 [] 索引
df <- data.frame(A = 1:5, B = 6:10)
df[1:3, "A"]  # 获取前3行A列的值

```

### 9. 使用`apply()`系列函数

-   通过 `apply()`, `lapply()`, `sapply()` 等函数对数据框、矩阵进行操作，这些函数有时也涉及到某种形式的索引。

```{r eval=FALSE}
# 对矩阵应用操作
m <- matrix(1:9, nrow=3, ncol=3)
apply(m, 1, sum)  # 对每一行求和，结果是每行的和

```

### 总结：

R 中的索引方式有很多，常用的包括**数字索引**、**逻辑索引**、**字符索引**、**负索引**、**范围索引**、**`which()`函数**等，具体选择哪种方式取决于数据结构和具体的需求。通过这些索引方法，我们能够高效地提取数据、进行数据筛选和操作。
